<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Quy·ªÅn Anh Sport Shop</title>

<style>
body{font-family:Arial;background:#f8f8f8;padding:20px}
h1{text-align:center;color:#ff4500}
input{width:100%;max-width:400px;padding:8px;border:2px solid #ff4500;border-radius:6px}

#result{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:15px;margin-top:20px}
.card{background:#fff;padding:12px;border-radius:10px;border:1px solid #ccc;text-align:center}
.card.selected{border:2px solid red}
.card img{width:100%;height:140px;object-fit:contain}

table{width:100%;border-collapse:collapse;margin-top:15px}
th,td{border:1px solid #ccc;padding:8px;text-align:center}
th{background:#ff4500;color:#fff}

button{padding:10px 20px;background:#ff4500;color:#fff;border:none;border-radius:6px;cursor:pointer}
button:hover{opacity:.9}

.popup{display:none;position:fixed;inset:0;background:rgba(0,0,0,.5);justify-content:center;align-items:center}
.popup-box{background:#fff;padding:20px;border-radius:10px;width:90%;max-width:400px}

.order-box{background:#fff8dc;padding:10px;margin-top:20px}
</style>
</head>

<body>

<h1>Quy·ªÅn Anh Sport Shop</h1>

<input placeholder="Nh·∫≠p t√™n s·∫£n ph·∫©m..." onkeyup="searchProduct(this.value)">
<div id="result"></div>

<div id="cart" style="display:none">
<h3>Gi·ªè h√†ng</h3>
<table>
<thead>
<tr><th>S·∫£n ph·∫©m</th><th>Gi√°</th><th>SL</th><th>Th√†nh ti·ªÅn</th></tr>
</thead>
<tbody id="cartBody"></tbody>
<tfoot>
<tr><td colspan="3">T·ªïng</td><td id="total">0</td></tr>
<tr><td colspan="3">Thu·∫ø 5%</td><td id="tax">0</td></tr>
<tr><td colspan="3"><b>Thanh to√°n</b></td><td id="final">0</td></tr>
</tfoot>
</table>
<button onclick="openPopup()">ƒê·∫∑t h√†ng</button>
</div>

<h3>ƒê∆†N H√ÄNG ƒê√É ƒê·∫∂T</h3>
<div id="orders"></div>

<!-- POPUP -->
<div class="popup" id="popup">
<div class="popup-box">
<h3>Th√¥ng tin kh√°ch h√†ng</h3>
<input id="customerName" placeholder="T√™n kh√°ch h√†ng"><br><br>
<input id="phone" placeholder="SƒêT"><br><br>
<input id="address" placeholder="ƒê·ªãa ch·ªâ"><br><br>
<button onclick="confirmOrder()">X√°c nh·∫≠n</button>
<button onclick="closePopup()">H·ªßy</button>
</div>
</div>

<script src="data.js"></script>
<script>
const cart={}, TAX=0.05;

// ===== TELEGRAM =====
const BOT="8273857573:AAEYcSW6HxSq_IJ8oNJfKrq6tVxhVUA3Y8U";
const CHAT="6403555640";

// ===== HI·ªÇN TH·ªä =====
function display(list){
 document.getElementById("result").innerHTML=list.map((p,i)=>`
 <div class="card ${cart[i]?'selected':''}">
 <b>${p.name}</b><br>${p.price.toLocaleString()} ƒë
 <img src="${p.image}">
 <br>
 <input type="checkbox" ${cart[i]?'checked':''} onchange="toggle(${i})"> Ch·ªçn
 </div>`).join("");
}
display(products);

function searchProduct(k){
 display(products.filter(p=>p.name.toLowerCase().includes(k.toLowerCase())));
}

// ===== GI·ªé H√ÄNG =====
function toggle(i){
 cart[i]?delete cart[i]:cart[i]=1;
 document.getElementById("cart").style.display=Object.keys(cart).length?"block":"none";
 updateCart(); display(products);
}

function updateCart(){
 let html="",total=0;
 for(let i in cart){
  let p=products[i],q=cart[i],sum=p.price*q;
  total+=sum;
  html+=`
  <tr>
   <td>${p.name}</td>
   <td>${p.price.toLocaleString()}</td>
   <td><input type="number" min="1" value="${q}"
    onchange="cart[${i}]=this.value;updateCart()"></td>
   <td>${sum.toLocaleString()}</td>
  </tr>`;
 }
 document.getElementById("cartBody").innerHTML=html;
 document.getElementById("total").innerText=total.toLocaleString();
 document.getElementById("tax").innerText=(total*TAX).toLocaleString();
 document.getElementById("final").innerText=(total*(1+TAX)).toLocaleString();
}

// ===== ORDER =====
function openPopup(){popup.style.display="flex"}
function closePopup(){popup.style.display="none"}

function confirmOrder(){
 const customerName = document.getElementById("customerName").value.trim();
 const phone = document.getElementById("phone").value.trim();
 const address = document.getElementById("address").value.trim();

 if(!customerName || !phone || !address){
   alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin");
   return;
 }

 const code="QA-"+Date.now();
 const time=new Date().toLocaleString("vi-VN");
 let msg=`üì¶ ƒê∆†N H√ÄNG M·ªöI
M√£: ${code}
‚è∞ ${time}
üë§ ${customerName}
üìû ${phone}
üè† ${address}

`;

 let total=0, html="";
 for(let i in cart){
  let p=products[i],q=cart[i],s=p.price*q;
  total+=s;
  msg+=`${p.name} x${q} = ${s.toLocaleString()}ƒë\n`;
  html+=`${p.name} x${q} = ${s.toLocaleString()}ƒë<br>`;
 }

 let tax=total*0.05, final=total+tax;
 msg+=`\nThu·∫ø 5%: ${tax.toLocaleString()}ƒë\nT·ªïng: ${final.toLocaleString()}ƒë`;

 orders.innerHTML+=`
 <div class="order-box">
 <b>M√£ ƒë∆°n:</b> ${code}<br>
 <b>Th·ªùi gian:</b> ${time}<br>
 <b>Kh√°ch h√†ng:</b> ${customerName}<br>
 <b>SƒêT:</b> ${phone}<br>
 <b>ƒê·ªãa ch·ªâ:</b> ${address}<br><br>
 ${html}
 <b>T·ªïng thanh to√°n:</b> ${final.toLocaleString()} ƒë
 </div>`;

 fetch(`https://api.telegram.org/bot${BOT}/sendMessage?chat_id=${CHAT}&text=${encodeURIComponent(msg)}`);

 for(let i in cart) delete cart[i];
 updateCart(); display(products); closePopup();
}

</script>
</body>
</html>
